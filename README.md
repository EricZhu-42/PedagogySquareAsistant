# 教学立方辅助插件
 一键预览助教批改作业页面上传的图片等实用功能，同时可以把课件页面未放开的下载打开，方便网络环境实在坑爹的同学。

> 所有课件均为任课老师的辛苦劳动付出，本插件使用者**仅可为了教学工作、课程学习方便之用，不得未经允许将课件在网络随意传播**！请珍惜老师的劳动成果和心血！（如果我发现任何一个人违反了这条，我会删去此功能）

> 此外需要说明的是，尽管这个插件没啥工作量，也必然会遇到版权之类的质疑，我仍然认为公开是合适的。校内网站的bug很多（包括曾经的教务网），以往是一上报就较快能修复或者注意，工作态度还挺认真的。但是教学立方这个产品已经实行有段日子了，周围学生和老师反馈各种不好用的地方，我没有看见它去考虑一些细节（而且都是些挺可行、成熟的方案）或者沟通交流（讨论区还有帖子没被回复，群里回复像且仅像是答疑）。既然无法改变对象，那就自己动手，这也是本插件诞生的原因。

## 原理

非常非常非常没有难度，看两天代码照着模板套你也可以做。

+ 预览图片：直接注入js脚本从页面获取作业真实下载链接，如果是图片就直接用`<canvas>...</canvas>`嵌入到网页绘制而不必单独下载，并且可以单击旋转图片。如果不是图片，就转换为真实下载链接而不是`javascript:void(0);`（好像并没有什么卵用，你可能需要“一键下载本页”这种功能，但把作业拆成多份pdf的学生估计百年一遇……）。

+ 放开下载：直接注入js脚本从页面修改课件可下载的属性。

## 安装方式

1. `clone`到本地（如果是`.zip`压缩包那解压成文件夹）

2. 打开Chrome或Chromium系浏览器，Chrome输入`chrome://extensions`，Chromium Edge输入`edge://extensions`

3. 打开“开发人员模式”

4. 点击“加载解压缩的扩展包”，选中本地的仓库文件夹

## 使用方式

### 通用

+ 允许使用背景模式

> **点击模式**：打开教学立方作业批改页面或课件列表，此时插件显示“Click”，点击插件图标。

> **背景模式**：打开教学立方作业批改页面或课件列表，此时插件显示“On”，无需做任何动作。

+ 可选隐藏客服悬浮按钮，防止遮挡

### 助教

目前功能有：

+ 预览图片附件，将下载链接改为真实链接（并无卵用）

+ 点击预览的图片（插入图片也可以，如果没用就刷新一下）可直接旋转

+ 为每个图片下面添加评语框，在最终评阅的时候会自动收集

+ 将“评阅”移动到了答题最下方，更加符合习惯

### 学生

目前功能有：

+ 可以显示“下载”图标，并且将其链接修改为真实下载地址，结合**DownThemAll!**插件或类似资源嗅探工具能够实现批量下载

## 已知问题

+ 由于本人能力有限只能暂时解决图片问题，pdf和word文档基本都是一个文档其实也不太妨碍。

+ 实际测试中，极个别图片显示不正常，目前不知道原因，但绝大多数可以用

+ 少数图片无法旋转时，尝试刷新页面

## 欢迎改进

非常非常非常欢迎有大佬看见感兴趣可以改进的，特别是文件预览因为url含有验证遭遇到不小麻烦，暂时没办法解决。当然最好的办法是官方技术能抽个小空来改造，这样这个插件从此就用不上了……

## 更新日志

### v1.1

+ 更名为教学立方辅助工具

+ 仿照原来的方式，增加了一键显示所有下载的功能

+ 吐槽：实现方式过于简单，这变量作用范围到底算bug还是算feature？

### v1.2

+ 重新整理了下其实基本已经全是自己写的内容了，所以重新做了许可

+ 对于改作业而言，增加了将“评阅”移到页面底部，看完作业直接评阅无需上翻

+ 增强了图片预览功能，在开启预览之后点击图片可以直接旋转图片（无论是原先就有的还是附件预览）

+ 添加了记录输入框，改小题的时候可以添加笔记，最后在评阅时汇总

### v1.3

+ 将课件的下载链接替换为真实下载地址，推荐结合**DownThemAll!**插件或类似工具能够实现批量下载

+ 修复了课件列表切下一页后“下载”消失的问题（是的，我用了Timer）

### v1.x (x>3)

+ 增加了很多bug

---

### v2.0.1 (重大更新)

+ 拆分重写了原先的各个模块

+ 允许多个自定义功能

+ 分为“点击”和“背景”模式

+ 采用新的版本号
